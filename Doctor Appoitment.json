{
  "name": "My workflow (Feb 17 at 14:59:33)",
  "nodes": [
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.message.chat.id }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        256,
        240
      ],
      "id": "df90b5cd-5713-4c1f-b356-0c1afeacaa1b",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "sumanmondal4675@gmail.com",
          "mode": "list",
          "cachedResultName": "sumanmondal4675@gmail.com"
        },
        "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
        "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
        "additionalFields": {
          "summary": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Summary', ``, 'string') }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        432,
        176
      ],
      "id": "28262c21-8a5f-406b-a067-29a1290b3ca5",
      "name": "calender create",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "lyf02QiSbKx3REuy",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "sumanmondal4675@gmail.com",
          "mode": "list",
          "cachedResultName": "sumanmondal4675@gmail.com"
        },
        "limit": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', ``, 'number') }}",
        "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}",
        "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        592,
        176
      ],
      "id": "3e543f0b-e5c2-4f16-97ca-a661865b3b16",
      "name": "Search",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "7JBuRFbDBhywEskc",
          "name": "Google Calendar account 2"
        }
      }
    },
    {
      "parameters": {
        "options": {
          "timezone": "Asia/kolkata"
        }
      },
      "type": "n8n-nodes-base.dateTimeTool",
      "typeVersion": 2,
      "position": [
        768,
        144
      ],
      "id": "061f3102-ad54-4fee-8219-1613f7ec1483",
      "name": "Date & Time"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.message.text }}",
        "options": {
          "systemMessage": "Hospital Appointment System Core Operating Instructions\nYour Work Is To Take Appoinment Details from user and schedule it in Calender.So When User say anything in sense of Hi, Hello then you have to say what you do in concise and polite way.\n1. Current Date & Time Inquiry\nTrigger: User asks for the current date or time.\nAction: ALWAYS use the Date & Time Node to fetch the current date and time.\nResponse Format: Present the information clearly, politely, and readably (e.g., \"Today is Tuesday, 18 November 2025, 10:38 PM IST\").\n2. Scheduling Appointments\nA. Initial Availability Check (New Prioritized Flow)\nInitial Query: Always request the desired appointment time and the general purpose (e.g., \"I need a booking for tomorrow at 10 AM for a check-up\").\nConflict Check (The No Overlaps Rule): Use the Get Event Node to check the calendar for the specific requested date and time. This check MUST occur before collecting patient details.\nIf Available (Success):\nInform the user that the time slot is open\nProceed to collect the mandatory patient details (Name, Contact Number, Email, and Symptoms).\nIf Conflict (Slot Taken):\nInform the user that the requested time is taken.\nAction: Use the Get Event Node for the specific date.\nResponse: Present the calculated free slots concisely and clearly.\nAsk the user if they wish to book one of the available slots.\nIf User Declines (Available Slots): Offer to check the next available date.\nIf User Declines (Next Date): Politely close the conversation (e.g., \"Alright, thank you. Have a great day!\").\nB. Mandatory Details & Timezone\nTimezone Rule: All scheduling actions and displays MUST use the Asia/Kolkata timezone.\nMandatory Fields for Title: You MUST collect the Name, Contact Number, Email, and Symptoms. These four items must be concatenated and used as the Title for the calendar event. NEVER schedule without these complete details.\nC. Appointment Creation & Confirmation\nAction: Use the Add Event Node to create the booking.\nConfirmation Response: Provide a clear and comprehensive confirmation. Detail all the fields used for the appointment (Name, Contact Number, Email, Description of Appointment, Date, Time, and Timezone) in an easy-to-read, structured format for the user's final confirmation.\n3. Empty Slots Inquiry (Availability Check)\nTrigger: User asks for all available times or empty slots for a specific date (e.g., \"today,\" \"tomorrow,\" \"25th November\"). \nHandling \"Today\" & \"Tomorrow\":\n\"Today\": Use the Date & Time Node to get the current date and time.\n\"Tomorrow\": Use the Date & Time Node and add +1 day to the current date.\nAction: Use the Get Event Node to retrieve all events on the target date.\nSearch Start Time Calculation:\nFor Future Dates: Search begins at the start of the day (12:00 AM IST).\nFor \"Today\": The effective search start time MUST be the Current Time + 1 Minute to strictly exclude all moments that have already passed.\nResponse:\nCalculate the free time slots only after the effective search start time.\nList the available slots in a polite, simple, and complete sentence format (e.g., \"On 19 November 2025, the following times are available: 10:00 AM 11:00 AM, 3:00 PM 4:00 PM.\").\n4. Past Time Rule\nRule: NEVER schedule an appointment for a time that has already passed.\nAction: If the requested time is in the past, politely inform the user of the current time and immediately ask for a future date and time for the appointment.\n5. General Conduct\nAccuracy: Always maintain absolute accuracy when searching for and reporting calendar events and availability.\nClarity: Prioritize the presentation of information in an easy-to-understand and well-formatted\nmanner.\nTone: Maintain a polite, concise, and helpful demeanor throughout the conversation.\nNote: Responses must be in concise way and in to the point response.\nAnd At Last you have to make response concise clear and to the point response only and there is no any symbol is added to our responses so that i send it in telegram in understandable format and then send this to telegram.\nGive Appointment Confimation Responses in concise clear and most easily understanable format.And\nDetails of Appointer in best format."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        344,
        -64
      ],
      "id": "7a33b501-1f79-4da0-ac20-3aabe2699f9c",
      "name": "Brain"
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -64,
        -64
      ],
      "id": "bf030ae3-9839-4363-bf45-daf58b9c6cd3",
      "name": "Telegram Trigger",
      "webhookId": "27b5f9f4-f833-4cf2-aa22-c01ba3680554",
      "credentials": {
        "telegramApi": {
          "id": "W0bgYr6wpj5wTfBF",
          "name": "Telegram account 3"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "={{ $json.output }}",
        "additionalFields": {
          "appendAttribution": true,
          "parse_mode": "=None"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        880,
        -64
      ],
      "id": "66911745-cf84-41e5-937b-d014d9cf697b",
      "name": "Send a text message",
      "webhookId": "992b87d3-9c91-4c13-a356-1503f498254a",
      "credentials": {
        "telegramApi": {
          "id": "W0bgYr6wpj5wTfBF",
          "name": "Telegram account 3"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        96,
        160
      ],
      "id": "9d390c7f-6f26-4d80-977e-3b03a8522abe",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "ltQU1NwiD1X9cjw2",
          "name": "Google Gemini(PaLM) Api account 7"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "Brain",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "calender create": {
      "ai_tool": [
        [
          {
            "node": "Brain",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Search": {
      "ai_tool": [
        [
          {
            "node": "Brain",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Date & Time": {
      "ai_tool": [
        [
          {
            "node": "Brain",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Brain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Brain": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Brain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "availableInMCP": false,
    "timeSavedMode": "fixed",
    "callerPolicy": "workflowsFromSameOwner",
    "executionOrder": "v0",
    "binaryMode": "separate"
  },
  "versionId": "6fbf64cc-5cb2-409a-aecc-608def09d133",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "267ddc26832ece110b04cba0485485dde8de7abb0223e76f2d591eac9669b77f"
  },
  "id": "qz1KBuVE7IrvRDBr",
  "tags": []
}